(()=>{"use strict";var e={4075:(e,t,a)=>{var n=a(6455),s=a.n(n),r=a(1035);const o={lines:10,length:0,width:12,radius:16,scale:1,corners:1,speed:1,rotate:0,animation:"spinner-line-shrink",direction:1,color:"#e74c3c",fadeColor:"transparent",top:"50%",left:"50%",shadow:"0 0 1px transparent",zIndex:2e9,className:"spinner",position:"absolute"};var c=a(7027),l=a(3438),i=a(5709);const d={success(e){alertify.success(e)},error(e){alertify.error(e)}},u=new class{constructor(e){this.target=e,this.spinner=new r.$(o)}start(){this.spinner.spin(this.target),this.target.classList.add("opaque")}stop(){this.spinner.stop(),this.target.classList.remove("opaque")}}(document.getElementById("purchase_orders")),p=1==CONFIG.approval_enabled;let f=1;function h(e=1){f=e,u.start();let t=new FormData;t.set("search",document.getElementById("search").value||""),t.set("page",e),t.set("from",document.getElementById("from_date_filter").value),t.set("to",document.getElementById("to_date_filter").value),fetch(`${CONFIG.BASE_URL}purchaseorder/get`,{method:"POST",body:t}).then((e=>e.json())).then((e=>{!function(e){let t='<tr><td align="center" colspan="9">No records found.</td></tr>';var a,n,r,o;e.list.length&&(t=e.list.reduce(((e,t)=>{return`${e}\n                    <tr>\n                        <td align="center"><a href="${CONFIG.BASE_URL}purchaseorder/equipments/${t.po_id}">${t.po_number}</a></td>\n                        <td><span class="font-medium">${t.supplier}</span>\n                            <br/>\n                            <span class="text-muted">\n                                ${t.supplier_address_building?t.supplier_address_building+", ":""}\n                                ${t.supplier_address_street?t.supplier_address_street+", ":""}\n                                ${t.supplier_address_city?t.supplier_address_city+", ":""}\n                                ${t.supplier_address_country?t.supplier_address_country:""}\n                            </span>\n                        </td>\n                        <td>\n                            <span class="font-medium">${t.client}</span>\n                            <br/>\n                            <span class="text-muted">\n                                ${t.cms_address_building?t.cms_address_building+", ":""}\n                                ${t.cms_address_street?t.cms_address_street+", ":""}\n                                ${t.cms_address_city?t.cms_address_city+", ":""}\n                                ${t.cms_address_country?t.cms_address_country:""}\n                            </span>\n                        </td>\n                        <td>${t.po_description}</td>\n                        <td align="center">${t.currency}</td>\n                        <td align="center">${t.po_document_date?t.po_document_date:t.po_date}</td>\n                        <td>${t.added_by}</td>\n                        <td>${a=t.po_status,"active"===a?'<span class="label label-success">OPEN</span>':"closed"===a?'<span class="label label-danger">CLOSED</span>':"approval"===a?'<span class="label label-warning">FOR APPROVAL</span>':"approved"===a?'<span class="label label-info">APPROVED</span>':"declined"===a?'<span class="label label-danger">DECLINED</span>':void 0}</td>\n                        <td align="center">\n                            <div class="btn-group">\n                                <button aria-expanded="false" data-toggle="dropdown" class="btn btn-default dropdown-toggle waves-effect waves-light" type="button"> <i class="fa fa-cog m-r-5"></i> <span class="caret"></span></button>\n                                <ul role="menu" class="dropdown-menu dropdown-menu-right">${function({po_id:e,po_number:t,po_status:a}){let n=`<li><a href="${CONFIG.BASE_URL}purchaseorder/equipments/${e}" title="View Details"><span class="fa fa-search"></span>&nbsp; View</a></li>`;return"active"==a&&(n=`${n}\n                <li><a href="${CONFIG.BASE_URL}purchaseorder/edit/${e}" title="Update"><span class="fa fa-pencil"></span>&nbsp; Update</a></li>\n                <li><a href="" class="delete-purchase-order-btn" title="Delete" data-index="${e}" data-name="${t}"><span class="fa fa-trash"></span>&nbsp; Delete</a></li>`),n=`${n}\n                <li><a href="" title="Create New Copy" class="create-copy-btn" data-index="${e}" data-name="${t}"><span class="fa fa-copy"></span>&nbsp; New Copy</a></li>`,["active","approved","declined"].includes(a)&&(n=`${n}\n                <li><a href="" title="Create New Revision" class="create-revision-btn" data-index="${e}" data-name="${t}"><span class="fa fa-file-word-o"></span>&nbsp; New Revision</a></li>`),["closed","declined"].includes(a)||(n=`${n}\n                <li><a href="" class="change-status-btn" title="Change Status" data-index="${e}" data-name="${t}" data-status="${a}"><span class="fa fa-info-circle"></span>&nbsp; Change Status</a></li>`),p&&!["closed","approved"].includes(a)||(n=`${n}\n                <li class="divider"></li>\n                <li><a href="${CONFIG.BASE_URL}purchaseorder/preview_pdf/${e}" target="_blank" title="Preview"><span class="fa fa-search-plus"></span>&nbsp; Preview</a></li>\n                <li><a href="${CONFIG.BASE_URL}purchaseorder/save_as_pdf/${e}" target="_blank" title="Download Pdf"><span class="fa fa-file-pdf-o"></span>&nbsp; Save as Pdf</a></li>\n                <li class="divider"></li>\n                <li><a href="${CONFIG.BASE_URL}purchaseorder/history/${e}" target="_blank" title="History"><span class="fa fa-history"></span>&nbsp; History</a></li>`),n}(t)}</ul>\n                            </div>\n                        </td>\n                    </tr>`;var a}),"")),document.getElementById("purchase-orders-table").innerHTML=t,document.getElementById("pagination").innerHTML=e.pagination,((e,t)=>{const a=document.querySelectorAll(".pagination a[href]");a.length&&(0,c.R)(a,"click").pipe((0,l.b)((e=>e.preventDefault())),(0,i.U)((e=>t(e.target.getAttribute("data-ci-pagination-page"))))).subscribe()})(0,h),a=document.getElementsByClassName("delete-purchase-order-btn"),n=document.getElementsByClassName("create-copy-btn"),r=document.getElementsByClassName("create-revision-btn"),o=document.getElementsByClassName("change-status-btn"),m(a,"click",(function(e){e.preventDefault();var t=e.currentTarget.dataset.index;g("Are you sure?",`Are you sure you want to cancel ${e.currentTarget.dataset.name}? <br>You won't be able to revert this.`,(function(){fetch(`${CONFIG.BASE_URL}purchaseorder/delete/${t}`).then((e=>e.json())).then((e=>{e.success&&(d.success("Successfully cancelled."),h(f))}))}))})),m(n,"click",(function(e){e.preventDefault();var t=e.currentTarget.dataset.index;g("Are you sure?",`Are you sure you want to create a new copy of Purchase Order ${e.currentTarget.dataset.name}?`,(function(){fetch(`${CONFIG.BASE_URL}purchaseorder/createCopy/${t}`).then((e=>e.json())).then((e=>{e.success?window.location.href=`${CONFIG.BASE_URL}purchaseorder/edit/${e.id}`:d.error(e.message)}))}))})),m(r,"click",(function(e){e.preventDefault();var t=e.currentTarget.dataset.index;g("Are you sure?",`Are you sure you want to create a new revision for Purchase Order ${e.currentTarget.dataset.name}?`,(function(){fetch(`${CONFIG.BASE_URL}purchaseorder/createRevision/${t}`).then((e=>e.json())).then((e=>{e.success?window.location.href=`${CONFIG.BASE_URL}purchaseorder/equipments/${e.id}`:d.error(e.message)}))}))})),m(o,"click",(async function(e){e.preventDefault();const t=e.currentTarget.dataset.index,a=e.currentTarget.dataset.name;let n=function(e){if(p){if(["active","approval"].includes(e))return{active:"OPEN",approval:"FOR APPROVAL"};if("approved"==e)return{closed:"CLOSE"}}else if("closed"!=e)return{active:"OPEN",closed:"CLOSE"}}(e.currentTarget.dataset.status);const{value:r}=await s().fire({title:`Change Status for ${a}`,input:"select",inputOptions:n,inputPlaceholder:"Select new status",showCancelButton:!0,inputValidator:e=>new Promise((t=>{""===e?t("You need to select new status."):t()}))});if(r){let e=new FormData;e.set("status",r),fetch(`${CONFIG.BASE_URL}purchaseorder/changeStatus/${t}`,{method:"POST",body:e}).then((e=>e.json())).then((e=>{var t;e.success?(d.success("Successfully changed."),e.send_mail_for_approval&&(t=e.po_id,fetch(`${CONFIG.BASE_URL}purchaseorder/sendApprovalEmail/${t}`).then((e=>e.json())).then((()=>{console.log("Email succesfully sent.")}))),h()):d.error(e.message)}))}}))}(e),u.stop()}))}function m(e,t,a){Array.from(e).forEach((function(e){e.addEventListener(t,a)}))}function g(e,t,a){s().fire({title:e,html:t,icon:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",allowOutsideClick:!0,reverseButtons:!0}).then((e=>{e.value&&a()}))}h(),jQuery(".datepicker").datepicker({autoclose:!0,todayHighlight:!0,format:"yyyy-mm-dd",clearBtn:!0}),$("#from_date_filter").on("change",(function(){h()})),$("#to_date_filter").on("change",(function(){h()})),document.getElementById("search").addEventListener("keyup",(function(){h()}))}},t={};function a(n){if(t[n])return t[n].exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,a),s.exports}a.m=e,a.x=e=>{},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.j=23,(()=>{var e={23:0},t=[[4075,216]],n=e=>{},s=(s,r)=>{for(var o,c,[l,i,d,u]=r,p=0,f=[];p<l.length;p++)c=l[p],a.o(e,c)&&e[c]&&f.push(e[c][0]),e[c]=0;for(o in i)a.o(i,o)&&(a.m[o]=i[o]);for(d&&d(a),s&&s(r);f.length;)f.shift()();return u&&t.push.apply(t,u),n()},r=self.webpackChunkhotware=self.webpackChunkhotware||[];function o(){for(var n,s=0;s<t.length;s++){for(var r=t[s],o=!0,c=1;c<r.length;c++){var l=r[c];0!==e[l]&&(o=!1)}o&&(t.splice(s--,1),n=a(a.s=r[0]))}return 0===t.length&&(a.x(),a.x=e=>{}),n}r.forEach(s.bind(null,0)),r.push=s.bind(null,r.push.bind(r));var c=a.x;a.x=()=>(a.x=c||(e=>{}),(n=o)())})(),a.x()})();